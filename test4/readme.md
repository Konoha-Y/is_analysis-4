# 实验4 图书管理系统顺序图绘制
|学号|班级|姓名|照片|
|:-------:|:-------------: | :----------:|:---:|
|201510414318|软件(本)15-3|吴江涛|![](./wjt.jpg '吴江涛')

#### 用例图参照实验2 [吴江涛_图书管理系统用例图](../test2/usecase_01.png "用例图")
#### 类图参照实验3 [吴江涛_图书管理系统类图](../test3/classDraw.png "类图")
* **根据用例图和类图，画出部分用例的顺序图包括：借书、还书、查找图书、预订图书、解除预订、查找用户信息、更新图书、更新借书者，因为删除和增加功能如同更新***

## 1.借书顺序图
### 1.1 代码如下 ：
      @startuml
             actor 图书管理员
             图书管理员->借书者:验证借书者
             图书管理员->借书者:取借书者限额
             loop
             图书管理员->资源项:获取资源项
             资源项->馆藏资源:查找资源类别和信息
             图书管理员->借书记录:创建借书记录
             图书管理员->资源项:借出资源
             资源项->馆藏资源:减少可借数量
             图书管理员->借书者:减少可用限额
             end
             图书管理员-->借书记录:打印借书清单
       @enduml
### 1.2 顺序图如下：
   ![](./borrowBook.png "图4.1 图书管理系统借书顺序图")
  * **说明:借书首先要验证借书者信息和额度，然后再由图书管理员发起借书请求，减少资源可借数量和可借额度，创建借书记录**

## 2.还书顺序图
### 2.1 代码如下：
```
    @startuml
        actor 图书管理员
        actor 借书者用户
        图书管理员->借书者用户:读取借书者信息
        借书者用户->资源项:读取资源信息
        资源项->借书记录:取借书记录
        资源项->馆藏资源:取资源的类别和信息
        借书者用户->资源项:归还资源
        资源项->馆藏资源:增加可借数量
        图书管理员->借书记录:登记还书日期
        opt 逾期
        图书管理员->逾期记录:登记逾期记录
        借书者-->图书管理员:交付罚金
        end
    @enduml
```
### 2.2 顺序图如下：
![](./returnBook.png '图4.2 图书管理系统还书顺序图')
* **说明:还书首先要验证借书者信息，然后再由图书管理员发起还书请求，增加资源可借数量和可借额度，然后登记还书日期，如果用户还书超期，还需进行逾期记录和罚款**

## 3.查找图书顺序图
### 3.1 代码如下：
```
    @startuml
        actor 系统管理员
        actor 图书管理员
        actor 借书者
        系统管理员->资源项:获取资源项
        图书管理员->资源项:获取资源项
        借书者->资源项:获取资源项
        资源项->馆藏资源:查找资源类别和信息
        馆藏资源->图书书目:查找图书
        图书书目-->系统管理员:返回图书
        图书书目-->图书管理员:返回图书
        图书书目-->借书者:返回图书
    @enduml
```
### 3.2 顺序图如下：
![](./findBook.png '图4.3 图书管理系统查找图书顺序图')
* **说明:查找图书由资源项管理，再到馆藏资源，图书书目继承馆藏资源，直接通过书名，ISBN，作者等项目查找图书**

## 4.查找用户个人信息顺序图
### 4.1 代码如下：
```
    @startuml
        actor 借书者用户
        借书者用户->借书者:查询帐户信息
        借书者-->借书者用户:返回帐户信息
        借书者->预订记录:查找预订记录
        预订记录-->借书者用户:返回预订信息
        借书者->借书记录:查找借书记录
        借书记录-->借书者用户:返回借书信息
        alt
        借书记录->逾期记录:查找逾期记录
        逾期记录-->借书者用户:返回逾期信息
        逾期记录->罚款记录:查找罚款记录
        罚款记录-->借书者用户:返回罚款信息
        end
    @enduml
```
### 4.2 顺序图如下：
![](./findUserInfo.png '图4.4 图书管理系统查找用户个人信息顺序图')
* **说明:查找用户信息有用户个人信息，有预订记录，有借书记录，有逾期和罚款记录，分别查找**

## 5.预订图书顺序图
### 5.1 代码如下：
```
    @startuml
        actor 图书管理员
        图书管理员->借书者:验证借书者
        图书管理员->借书者:取借书者限额
        loop
        图书管理员->资源项:获取资源项
        资源项->馆藏资源:查找资源品种
        图书管理员->预订记录:创建预定记录
        资源项->馆藏资源:减少可借数量
        预定记录-->借书者:借书成功
        end
        图书管理员->预订记录:打印预定清单
    @enduml
```
### 5.2 顺序图如下：
![](./reserveBook.png '图4.5 图书管理系统预订图书顺序图')
* **说明:预订图书首先验证借书者信息和额度，再由图书管理员发起预订，减少资源可借数目，创建用户预订记录，并打印预订清单**

## 6.解除预订顺序图
### 6.1 代码如下：
```
@startuml
    actor 图书管理员
        图书管理员->借书者:验证借书者
        图书管理员->预订记录:取预定记录
        图书管理员->预订记录:标记预定记录
    @enduml
```
### 6.2 顺序图如下：
![](./bookManager.png '图4.6 图书管理系统解除预订顺序图')
* **说明:解除预订先验证借书者信息，查找有无预订记录，然后对预订记录进行标记，表明此条记录已经失效，加入时间戳**

## 7.更新图书顺序图
### 7.1 代码如下：
```
    @startuml
        actor 系统管理员
        系统管理员->资源项:获取资源项信息
        资源项->馆藏资源:查询资源信息
        馆藏资源->图书书目:查询书目信息
        系统管理员->图书书目:更新书目信息
    @enduml
```
### 7.2 顺序图如下：
![](./updateBook.png '图4.7 图书管理系统更新图书顺序图')
* **说明:更新图书由系统管理员操作，由馆藏资源找到图书书目，直接对图书书目进行更新即可，添加图书也是如此，删除图书需要先查找图书**

### 8.更新用户顺序图
#### 8.1 代码如下：
```
    @startuml
        actor 系统管理员
        系统管理员->借书者用户:查找借书者用户
        借书者用户-->系统管理员:返回借书者用户信息
        系统管理员->借书者用户:更新借书者用户信息
    @enduml
```
### 8.2 顺序图如下：
![](./updateUser.png '图4.8 图书管理系统更新用户顺序图')
* **说明:更新借书者由系统管理员操作，直接对借书者进行更新，添加借书者也是如此，删除需要先查找借书者** 